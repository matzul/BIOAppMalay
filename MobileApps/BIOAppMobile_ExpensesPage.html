<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BIOApp Mobile</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="shortcut icon" href="img/logo.png" />
    <link href="css/loading.css" rel="stylesheet" type="text/css">

    <link href="googleapis/css/fonts.css" rel="stylesheet">
    <!--<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">-->

    <link rel="stylesheet" href="normalize/normalize.css">
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">-->

    <!-- Bootstrap 3.3.6 -->
    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css" />
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css" />-->

    <!-- Font Awesome -->
    <link rel="stylesheet" href="ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css" />
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css" />-->

    <!-- Ionicons -->
    <link rel="stylesheet" href="ajax/libs/ionicons/2.0.1/css/ionicons.min.css" />
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/4.5.6/css/ionicons.min.css" />-->

    <!-- DataTables -->
    <link rel="stylesheet" href="datatables/css/dataTables.bootstrap.css">
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/datatables/1.10.19/css/dataTables.bootstrap.min.css">-->

    <!-- Theme style -->
    <link rel="stylesheet" href="dist/css/AdminLTE.min.css" />
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/2.4.10/css/AdminLTE.min.css" />-->

    <link rel="stylesheet" href="dist/css/skins/_all-skins.min.css" />
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/2.4.10/css/skins/_all-skins.min.css" />-->

    <!--[if lt IE 9]>
      <script src="html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style>
        body {
            padding: 0px;
            padding-bottom: 50px;
        }

        .mobile-bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            will-change: transform;
            -webkit-transform: translateZ(0);
            transform: translateZ(0);
            display: flex;
            height: 50px;
            box-shadow: 0 -2px 5px -2px #333;
            background-color: #fff;
        }

        .mobile-bottom-nav__item {
            flex-grow: 1;
            text-align: center;
            font-size: 12px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .mobile-bottom-nav__item--active {
            color: red;
        }

        .mobile-bottom-nav__item-content {
            display: flex;
            flex-direction: column;
        }

        /* link */
        .content-wrapper {
            background-color: inherit;
        }

        .pagination {
            float: right !important;
            margin: inherit;
        }

        a {
            text-decoration: none;
            color: #003399;
        }

            a:hover {
                color: #0033cc;
                text-decoration: underline;
            }

            a:active {
                color: #0066FF;
            }

        #wrap {
            position: relative;
            background-image: url(images/wrap.gif);
            background-color: #fff;
        }

        /* clearer */

        /* clearfix */
        .clearfix:after {
            content: ".";
            display: block;
            height: 0;
            clear: both;
            visibility: hidden;
        }

        .clearfix {
            display: inline-table;
            min-height: 1%;
        }
        /* Hides from IE-mac \*/
        * html .clearfix {
            height: 1%;
        }

        .clearfix {
            display: block;
        }
        /* End hide from IE-mac */

        .product_price {
            margin: 0px;
            padding: 5px 10px;
            background-color: #FFF;
            text-align: left;
            bexpenses: 2px dashed #E0E0E0
        }
    </style>

    <script>
        window.console = window.console || function (t) { };
    </script>
    <script>
        if (document.location.search.match(/type=embed/gi)) {
            window.parent.postMessage("resize", "*");
        }
    </script>
    <style>
        .breadcrumb {
            margin-bottom: 10px;
        }

        ul.breadcrumb {
            padding: 10px 16px;
            list-style: none;
            background-color: #eee;
        }

            ul.breadcrumb li {
                display: inline;
                font-size: 18px;
            }

                ul.breadcrumb li + li:before {
                    padding: 8px;
                    color: black;
                    content: "/\00a0";
                }

                ul.breadcrumb li a {
                    color: #0275d8;
                    text-decoration: none;
                }

                    ul.breadcrumb li a:hover {
                        color: #01447e;
                        text-decoration: underline;
                    }
    </style>
</head>
<body translate="no">

    <!-- Modal -->
    <div class="modal fade" id="myDIV" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-body">
                    <div class="center-block"><img class="center-block" src="img/loader.gif" width="32" height="32" alt="" /></div>
                    <p class="text-center"> Loading...</p>
                </div>

            </div>
        </div>
    </div>

    <div class="modal fade" id="myReceiptList" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <table id="tbReceiptList" class="table" style="width:100%;">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th style="display:none;">rowno</th>
                                <th style="display:none;">bpid</th>
                                <th>bpdesc</th>
                                <th style="display:none;">receiptno</th>
                                <th style="display:none;">receiptlineno</th>
                                <th style="display:none;">orderno</th>
                                <th style="display:none;">orderlineno</th>
                                <th style="display:none;">itemno</th>
                                <th>Senarai Penghantaran</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-primary" onclick="addreceiptitem();">Tambah</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="myBPList" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <table id="tbBPList" class="table" style="width:100%;">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th style="display:none;">bpid</th>
                                <th style="display:none;">bpdesc</th>
                                <th style="display:none;">bpaddress</th>
                                <th style="display:none;">bptelno</th>
                                <th>Senarai Pelanggan</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="myItemList" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <table id="tbItemList" class="table" style="width:100%;">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th style="display:none;">rowno</th>
                                <th style="display:none;">receiptno</th>
                                <th style="display:none;">receipt_lineno</th>
                                <th style="display:none;">orderno</th>
                                <th style="display:none;">order_lineno</th>
                                <th style="display:none;">itemno</th>
                                <th style="display:none;">itemdesc</th>
                                <th style="display:none;">unitcost</th>
                                <th style="display:none;">unitprice</th>
                                <th style="display:none;">discamount</th>
                                <th style="display:none;">quantity</th>
                                <th style="display:none;">costprice</th>
                                <th style="display:none;">expensesprice</th>
                                <th style="display:none;">taxcode</th>
                                <th style="display:none;">taxrate</th>
                                <th style="display:none;">taxamount</th>
                                <th style="display:none;">totalexpenses</th>
                                <th>Senarai Item/ Produk</th>
                                <th>Qty</th>
                                <th>Jumlah</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-primary" onclick="addlineitem();">Tambah</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="myItemList2" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <table id="tbItemList2" class="table" style="width:100%;">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th style="display:none;">rowno</th>
                                <th style="display:none;">itemno</th>
                                <th style="display:none;">itemdesc</th>
                                <th>Senarai Item/ Produk</th>
                                <th style="display:none;">Qty/Harga</th>
                                <th style="display:none;">Jumlah</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="myLineItem" role="dialog" style="width:100%;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    Kemaskini Item Pesanan
                </div>
                <div class="modal-body">
                    <table id="tbLineItem" class="table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Item/ Produk</th>
                                <!--<th style="width: 30px">Jumlah</th>-->
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td><span id="lblLineItemNo" name="lblLineItemNo"></span>
                                    <input id="txtLineItemDesc" name="txtLineItemDesc" readonly="readonly" value="" class="form-control"/>
                                    <input id="txtLineNo" name="txtLineNo" type="hidden" value="0" />
                                    <input id="txtReceiptNo" name="txtReceiptNo" type="hidden" value="" />
                                    <input id="txtReceiptLineNo" name="txtReceiptLineNo" type="hidden" value="0" />
                                    <input id="txtLineItemNo" name="txtLineItemNo" type="hidden" value="" />
                                    Harga: <br />
                                    <input id="txtLineUnitPrice" name="txtLineUnitPrice" type="text" readonly="readonly" value="0" style="width:60px;" /><br />
                                    Qty: <br/>
                                    <input id="txtLineItemQty" name="txtLineItemQty" type="text" readonly="readonly" value="0" style="width:30px;" /><br/>
                                    TAX Code: <br />
                                    <select id="selTaxCode" name="selTaxCode" readonly="readonly" style="width:60px;"></select>
                               </td>
                                <!--
                                <td width="50px;">
                                    <span id="lblLineTotalExpenses" name="lblLineTotalExpenses"></span>
                                </td>
                                -->
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-sm btn-warning pull-left" onclick="deletelineitem();">Hapus</button>
                    <button id="btnEditLineItem" name="btnEditLineItem" type="button" class="btn btn-sm btn-primary" onclick="editlineitem();">Kemaskini</button>
                </div>
            </div>
        </div>
    </div>

    <!--END Modal -->

    <div class="wrapper">
        <!-- Content Header (Page header) -->
        <div class="row col-lg-offset-2 col-md-offset-1 col-sm-offset-1 col-lg-8 col-md-10 col-sm-10">
            <section class="content-header">
                <h1>
                    BIL BELANJA
                    <small>BIOApp Mobile</small>
                </h1>
            </section>

            <!-- Main content -->
            <section class="content" style="align-self: center;">
                <ol class="breadcrumb" style="align-self: auto;">
                    <li class="breadcrumb-item"><a href="#" onclick="openlist();"><i class="fa fa-list"></i> Senarai</a></li>
                    <li class="breadcrumb-item active">Bil Belanja <span id="comp" name="comp"></span></li>
                </ol>
                <div id="searchblock" name="searchblock" class="menu-info" style="display:none;">
                    <select id="searchtype" name="searchtype" class="col-lg-6 col-md-6 col-sm-6 col-xs-6 bg-gray" style="margin-bottom:5px;height:28px;">
                        <option value="RECEIPTNO" selected>No. Penerimaan</option>
                        <option value="ORDERNO">No. Pesanan</option>
                        <option value="BPID">No. Pelanggan</option>
                        <option value="BPDESC">Nama Pelanggan</option>
                    </select>
                    <input type="text" id="searchitem" name="searchitem" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" style="margin-bottom:5px;height:28px;" placeholder="Carian..." />
                    <!--<div id="searchbpiddesc-container" style="position: relative; float: left; width: 100%; margin: 10px;"></div>-->
                    <a href="#" onclick="searching();" class="btn btn-default btn-flat" style="margin-bottom:5px;">Carian</a>
                    <a href="#" onclick="resetsearching();" class="btn btn-default btn-flat" style="margin-bottom:5px;">Reset</a>
                </div>
                <div id="foundblock" name="foundblock" class="menu-info">
                    <input type="text" id="foundlabelbpid" name="foundlabelbpid" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="Id Pelanggan:" />
                    <input type="text" id="foundbpid" name="foundbpid" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="" value="" />
                    <input type="text" id="foundlabelbpdesc" name="foundlabelbpdesc" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="Nama Pelanggan:" />
                    <input type="text" id="foundbpdesc" name="foundbpdesc" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="" value="" />
                    <input type="text" id="foundlabelbpaddress" name="foundlabelbpaddress" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="Alamat:" />
                    <input type="text" id="foundbpaddress" name="foundbpaddress" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="" />
                    <input type="text" id="foundlabelbpcontact" name="foundlabelbpcontact" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="Pegawai:" />
                    <input type="text" id="foundbpcontact" name="foundbpcontact" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="" />
                    <input type="text" id="foundlabelexpensescat" name="foundlabelexpensescat" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;height:28px;" placeholder="Kategori:" />
                    <select id="foundexpensescat" name="foundexpensescat" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" style="margin-bottom:5px;height:28px;">
                        <option value="PURCHASE_INVOICE">INVOIS BELIAN</option>
                        <option value="PAYMENT_VOUCHER">VOUCHER BAYARAN</option>
                        <!--<option value="JOURNAL_VOUCHER">VOUCHER PERLARASAN</option>-->
                    </select>
                    <input type="text" id="foundlabelexpensestype" name="foundlabelexpensestype" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;height:28px;" placeholder="Jenis:" />
                    <select id="foundexpensestype" name="foundexpensestype" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" style="margin-bottom:5px;height:28px;">
                        <option value="NOT_APPLICABLE">TIDAK BERKENAAN</option>
                        <option value="FINANCIAL_RELINQUISHMENTS">PENGEMBALIAN KEWANGAN</option>
                        <!--
                        <option value="BANK_DEPOSIT">DEPOSIT BANK</option>
                        <option value="CASH_WITHDRAWAL">PENGELUARAN TUNAI</option>
                        -->
                        <option value="SUPPLY_EXPENSES">BEKALAN & BAHAN MENTAH</option>
                        <option value="SALARIES_WAGES">GAJI & UPAH</option>
                        <option value="TRAVEL_EXPENSES">PERBELANJAAN PERJALANAN</option>
                        <option value="ENTERTAINMENT_EXPENSES">HIBURAN & KERAIAN</option>
                        <option value="EMPLOYEE_BENEFIT">MANFAAT & KEMUDAHAN PEKERJA</option>
                        <option value="MARKETING_ADVERTISING">PEMASARAN & PROMOSI</option>
                        <option value="RENTAL_LEASING">SEWAAN & PAJAKAN</option>
                        <option value="REPAIR_MAINTENANCE">PEMBAIKAN & PENYELENGGARAAN</option>
                        <option value="DEPRECIATION_EXPENSES">SUSUT NILAI</option>
                        <option value="BAD_DEBT_EXPENSES">HUTANG LAPOK</option>
                        <option value="SUBSCRIPTION_REGISTRATION">PENDAFTARAN & MELANGGAN</option>
                        <option value="INSURANCE_SECURITY">INSURANS & KESELAMATAN</option>
                        <option value="PROFESSIONAL_STATUTORY">PROFESIONAL & STATUTORI</option>
                        <option value="BILL_UTILITIES">BIL UTILITI</option>
                        <option value="TAXATION">PERCUKAIAN (TAX)</option>
                        <option value="SELLING_SERVICES">KOS PENJUALAN & PERKHIDMATAN</option>
                        <option value="OTHER_EXPENSES">PERBELANJAAN LAIN-LAIN</option>
                    </select>
                    <a href="#" onclick="createexpenses();" class="btn btn-default btn-flat" style="margin-bottom:5px;">Teruskan</a>
                    <a href="#" onclick="resetfound();" class="btn btn-default btn-flat" style="margin-bottom:5px;">Reset</a>
                </div>
                <div id="recordblock" name="recordblock" class="menu-info" style="margin-bottom:5px;display:none;">
                    <input type="text" id="recordlabelexpensesno" name="recordlabelexpensesno" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="No. Bil:" />
                    <input type="text" id="recordexpensesno" name="recordexpensesno" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="" />
                    <input type="text" id="recordlabelexpensesdate" name="recordlabelexpensesdate" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="Tarikh Bil:" />
                    <input type="text" id="recordexpensesdate" name="recordexpensesdate" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="" />
                    <input type="text" id="recordlabelexpensescat" name="recordlabelexpensescat" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="Kategori:" />
                    <input type="text" id="recordexpensescat" name="recordexpensescat" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="" />
                    <input type="text" id="recordlabelexpensestype" name="recordlabelexpensestype" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="Jenis:" />
                    <input type="text" id="recordexpensestype" name="recordexpensestype" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="" />
                    <input type="text" id="recordlabelbpid" name="recordlabelbpid" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="Pelanggan:" />
                    <input type="text" id="recordbpid" name="recordbpid" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;display:none;" placeholder="" />
                    <input type="text" id="recordbpdesc" name="recordbpdesc" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="" />
                    <input type="text" id="recordlabelbpaddress" name="recordlabelbpaddress" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="Alamat:" />
                    <input type="text" id="recordbpaddress" name="recordbpaddress" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="" />
                    <input type="text" id="recordlabelbpcontact" name="recordlabelbpcontact" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="Pegawai:" />
                    <input type="text" id="recordbpcontact" name="recordbpcontact" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="" />
                    <input type="text" id="recordlabelexpensesremarks" name="recordlabelexpensesremarks" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="Catatan:" />
                    <input type="text" id="recordexpensesremarks" name="recordexpensesremarks" class="col-lg-6 col-md-6 col-sm-6 col-xs-6" readonly="readonly" style="margin-bottom:5px;" placeholder="" />
                    <input type="text" id="recordexpensesstatus" name="recordexpensesstatus" class="product_price form-control" readonly="readonly" value="NEW" style="text-align:left;" />
                </div>
                <div class="box">
                    <div id="additemblock" name="additemblock" class="box-header" style="display:none;">
                        <button type="button" class="btn btn-sm" onclick="addnewitem();"><i class="fa fa-plus"></i></button>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body no-padding">

                        <table id="itemlist" class="table">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th style="display:none;">Comp</th>
                                    <th style="display:none;">ExpensesNo</th>
                                    <th style="display:none;">LineNo</th>
                                    <th style="display:none;">ReceiptNo</th>
                                    <th style="display:none;">ReceiptLineNo</th>
                                    <th style="display:none;">ItemNo</th>
                                    <th style="display:none;">Desc</th>
                                    <th>No. Item / Produk</th>
                                    <th>Qty</th>
                                    <th style="display:none;">UnitPrice</th>
                                    <th>Harga</th>
                                    <th style="display:none;">TaxCode</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>

                    </div>
                    <!-- /.box-body -->
                </div>
                <!-- /.box -->
                <div class="menu-info">
                    <a id="btnPaymentPaid" name="btnPaymentPaid" href="#" class="btn btn-default btn-flat" onclick="openpaymentpaid();" style="margin-bottom:5px;">Bayaran Belanja</a>
                    <a id="btnCancel" name="btnCancel" href="#" class="btn btn-default btn-flat" onclick="cancelexpenses();" style="margin-bottom:5px;display:none;">Batal</a>
                    <a id="btnBack" name="btnBack" href="#" onclick="openlist();" class="btn btn-default btn-flat" style="margin-bottom:5px;">Kembali</a>
                </div>
            </section>
            <!-- /.content -->

        </div>
    </div>
    <nav class="mobile-bottom-nav">
        <div id="list" class="mobile-bottom-nav__item">
            <div class="mobile-bottom-nav__item-content">
                <i class="material-icons">menu</i>
                Senarai
            </div>
        </div>
        <div id="expenses" class="mobile-bottom-nav__item mobile-bottom-nav__item--active">
            <div class="mobile-bottom-nav__item-content">
                <i class="material-icons">credit_card</i>
                Bil
            </div>
        </div>
        <div id="report" class="mobile-bottom-nav__item">
            <div class="mobile-bottom-nav__item-content">
                <i class="material-icons">receipt</i>
                Laporan
            </div>
        </div>
    </nav>

    <!-- JQuery -->
    <script src="https://adminlte.io/themes/AdminLTE/bower_components/jquery/dist/jquery.min.js"></script>
    <!--<script src="dist/js/jquery.min.js"></script>-->
    <!-- Bootstrap 3.3.6 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!--<script src="bootstrap/js/bootstrap.min.js"></script>-->
    <!-- AdminLTE App -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/admin-lte/2.3.11/js/app.min.js"></script>
    <!--<script src="dist/js/app.min.js"></script>-->
    <!-- DataTables -->
    <script src="https://adminlte.io/themes/AdminLTE/bower_components/datatables.net/js/jquery.dataTables.min.js"></script>
    <!--<script src="datatables/js/jquery.dataTables.js"></script>-->

    <script src="https://adminlte.io/themes/AdminLTE/bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
    <!--<script src="datatables/js/bootstrap.dataTables.js"></script>-->
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/JQuery.WebService.Call.Helper.js" type="text/javascript"></script>

    <script id="rendered-js">
        var navItems = document.querySelectorAll(".mobile-bottom-nav__item");
        navItems.forEach(function (e, i) {
            e.addEventListener("click", function (e) {
                navItems.forEach(function (e2, i2) {
                    e2.classList.remove("mobile-bottom-nav__item--active");
                });
                this.classList.add("mobile-bottom-nav__item--active");
                if (this.id == "list") {
                    window.location.href = "BIOAppMobile_ExpensesList.html?userid=" + userid;
                }
                else if (this.id == "expenses") {
                    window.location.href = "BIOAppMobile_ExpensesPage.html?userid=" + userid;
                }
                else if (this.id == "report") {
                    window.location.href = "BIOAppMobile_ExpensesList.html?userid=" + userid;
                }
            });
        });

        function getParameterByName(name) {
            name = name.replace(/[[]/, "\[").replace(/[]]/, "\]");
            var regex = new RegExp("[\?&]" + name + "=([^&#]*)"), results = regex.exec(location.search);
            return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
        }

    </script>
    <script>
        var userid;
        var comp;
        var bpid = "";
        var expensesno = "";

        var oTable;
        var bpTable;
        var receiptTable;
        var searchBPArray;
        var successcreationexpenses = false;
        var successadditem = false;
        var successedititem = false;
        var successdeleteitem = false;
        var successcancelexpenses = false;
        var errormessage = "";
        var itemTable;
        var itemTable2;

        $(document).ready(function () {

            $('#myDIV').modal({ backdrop: "static" });

            userid = getParameterByName('userid');
            comp = getParameterByName('comp');
            expensesno = getParameterByName('expensesno');

            if (comp && comp.length) 
            {
                if (expensesno && expensesno.length) 
                {
                }
                else
                {
                    var parameters_getMobile_UserProfile = ["userid", userid];
                    PageMethod("getMobile_UserProfile", parameters_getMobile_UserProfile, succeededAjaxFn_getMobile_UserProfile, failedAjaxFn_getMobile_UserProfile, false);
                }
            }
            else
            {
                var parameters_getMobile_UserProfile = ["userid", userid];
                PageMethod("getMobile_UserProfile", parameters_getMobile_UserProfile, succeededAjaxFn_getMobile_UserProfile, failedAjaxFn_getMobile_UserProfile, false);
            }

            $('#comp').text('[' + comp + ']');

            var parameters_getMobile_TaxCodeList = ["comp", comp];
            PageMethod("getMobile_TaxCodeList", parameters_getMobile_TaxCodeList, succeededAjaxFn_getMobile_TaxCodeList, failedAjaxFn_getMobile_TaxCodeList, false);

            oTable = $('#itemlist').DataTable({
                'paging': false,
                'lengthChange': false,
                'searching': false,
                'ordering': true,
                'info': false,
                'autoWidth': true,
                "columnDefs": [
                    {
                        "targets": [1],
                        "visible": false,
                        "searchable": false
                    },
                    {
                        "targets": [2],
                        "visible": false
                    },
                    {
                        "targets": [3],
                        "visible": false
                    },
                    {
                        "targets": [4],
                        "visible": false
                    },
                    {
                        "targets": [5],
                        "visible": false
                    },
                    {
                        "targets": [6],
                        "visible": false
                    },
                    {
                        "targets": [7],
                        "visible": false
                    },
                    {
                        "targets": [10],
                        "visible": false
                    },
                    {
                        "targets": [12],
                        "visible": false
                    }

                ]
            });

            bpTable = $('#tbBPList').DataTable({
                'paging': true,
                'pageLength': 3,
                'lengthChange': false,
                'searching': true,
                'ordering': true,
                'info': false,
                'autoWidth': true,
                "columnDefs": [
                    {
                        "targets": [1],
                        "visible": false,
                        "searchable": false
                    },
                    {
                        "targets": [2],
                        "visible": false
                    },
                    {
                        "targets": [3],
                        "visible": false
                    },
                    {
                        "targets": [4],
                        "visible": false
                    }
                ]
            });
            
            receiptTable = $('#tbReceiptList').DataTable({
                'scrollY': '50vh',
                'scrollCollapse': true,
                'paging': false,
                'lengthChange': false,
                'searching': true,
                'ordering': false,
                'info': false,
                'autoWidth': true,
                /*
                'initComplete': function () {
                    this.api().column(2).every( function () {
                        var column = this;
                        var select = jQuery('<select id="filterbp" name="filterbp"><option value="">-Select-</option></select>')
                        .appendTo( jQuery(column.header()).empty() )
                        .on('change', function () {
                            var val = jQuery.fn.dataTable.util.escapeRegex(
                                jQuery(this).val()
                            );
                            column.search( val ? '^'+val+'$' : '', true, false ).draw();
                        });
                    });
                },   
                */
                'columnDefs': [
                    {
                        "targets": [1],
                        "visible": false,
                        "searchable": false
                    },
                    {
                        "targets": [2],
                        "visible": false,
                        "searchable": false
                    },
                    {
                        "targets": [4],
                        "visible": false
                    },
                    {
                        "targets": [5],
                        "visible": false
                    },
                    {
                        "targets": [6],
                        "visible": false
                    },
                    {
                        "targets": [7],
                        "visible": false
                    },
                    {
                        "targets": [8],
                        "visible": false
                    }
                ]
            });            

            itemTable = $('#tbItemList').DataTable({
                'scrollY': '50vh',
                'scrollCollapse': true,
                'paging': false,
                'lengthChange': false,
                'searching': true,
                'ordering': false,
                'info': false,
                'autoWidth': false,
                'columnDefs': [
                    {
                        "targets": [1],
                        "visible": false,
                        "searchable": false
                    },
                    {
                        "targets": [2],
                        "visible": false
                    },
                    {
                        "targets": [3],
                        "visible": false
                    },
                    {
                        "targets": [4],
                        "visible": false
                    },
                    {
                        "targets": [5],
                        "visible": false,
                        "searchable": false
                    },
                    {
                        "targets": [6],
                        "visible": false
                    },
                    {
                        "targets": [7],
                        "visible": false
                    },
                    {
                        "targets": [8],
                        "visible": false
                    },
                    {
                        "targets": [9],
                        "visible": false,
                        "searchable": false
                    },
                    {
                        "targets": [10],
                        "visible": false
                    },
                    {
                        "targets": [11],
                        "visible": false
                    },
                    {
                        "targets": [12],
                        "visible": false
                    },
                    {
                        "targets": [13],
                        "visible": false,
                        "searchable": false
                    },
                    {
                        "targets": [14],
                        "visible": false
                    },
                    {
                        "targets": [15],
                        "visible": false
                    },
                    {
                        "targets": [16],
                        "visible": false
                    },
                    {
                        "targets": [17],
                        "visible": false
                    }

                ]
            });

            itemTable2 = $('#tbItemList2').DataTable({
                'paging': true,
                'pageLength': 3,
                'lengthChange': false,
                'searching': true,
                'ordering': true,
                'info': false,
                'autoWidth': true,
                "columnDefs": [
                    {
                        "targets": [1],
                        "visible": false,
                        "searchable": false
                    },
                    {
                        "targets": [2],
                        "visible": false
                    },
                    {
                        "targets": [3],
                        "visible": false
                    },
                    {
                        "targets": [5],
                        "visible": false
                    },
                    {
                        "targets": [6],
                        "visible": false
                    }
                ]
            });

            if (userid && userid.length) {
                if (comp && comp.length) {
                    if (expensesno && expensesno.length) {
                        $('#searchblock').hide();
                        $('#foundblock').hide();
                        $('#recordblock').show();

                        var parameters_getMobile_ExpensesDetails = ["comp", comp, "expensesno", expensesno];
                        PageMethod("getMobile_ExpensesDetails", parameters_getMobile_ExpensesDetails, succeededAjaxFn_getMobile_ExpensesDetails, failedAjaxFn_getMobile_ExpensesDetails, false);

                        var parameters_getMobile_ExpensesItems = ["comp", comp, "expensesno", expensesno];
                        PageMethod("getMobile_ExpensesItems", parameters_getMobile_ExpensesItems, succeededAjaxFn_getMobile_ExpensesItems, failedAjaxFn_getMobile_ExpensesItems, false);

                    } else {
                        $('#searchblock').show();
                        $('#foundblock').hide();
                        $('#recordblock').hide();
                        $('#additemblock').hide();
                    }
                } else {
                    $('#searchblock').show();
                    $('#foundblock').hide();
                    $('#recordblock').hide();
                    $('#additemblock').hide();
                    alert('Internal system error!');
                }
            } else {
                $('#searchblock').show();
                $('#foundblock').hide();
                $('#recordblock').hide();
                $('#additemblock').hide();
                alert('Internal system error!');
            }

            $('#itemlist tbody').on('click', 'tr', function () {
                var data = oTable.row(this).data();
                //alert('You clicked on ' + data[1] + ':' + data[2]);
                if ($('#recordexpensesstatus').val() != 'CONFIRMED' && $('#recordexpensesstatus').val() != 'CANCELLED') {
                    viewlineitem(data[3], data[4], data[5], data[6], data[7], data[9], data[10], data[11], data[12]);
                }
            });

            $('#tbBPList tbody').on('click', 'tr', function () {
                var data = bpTable.row(this).data();
                openbpdetails(data[1], data[2], data[3], data[4]);
            });

            /*
            $('#tbItemList tbody').on('click', 'tr', function () {
                var data = itemTable.row(this).data();
                additemdetails(data[1], data[2], data[3], data[4], data[5], data[6], data[7], data[8], data[9], data[10], data[11], data[12], data[13], data[14], data[15], data[16]);
            });
            */

            $('#tbItemList2 tbody').on('click', 'tr', function () {
                var data = itemTable2.row(this).data();
                additemdetails(data[1], "", 0, "", 0, data[2], data[3], 0, 0, 0, 0, 0, 0, "N/A", 0, 0, 0);
            });

            /*
            var parameters_getMobile_BPListAutocomplete = ["bpid", "", "bpdesc", "", "bpreference", "", "bpcat", ""];
            PageMethod("getMobile_BPListAutocomplete", parameters_getMobile_BPListAutocomplete, succeededAjaxFn_getMobile_BPListAutocomplete, failedAjaxFn_getMobile_BPListAutocomplete, false);
            */

            $('#myReceiptList').on('shown', function() {
                //$("#txtname").focus();
                setTimeout(function(){ 
                    receiptTable.columns.adjust();
                    /*
                    var select = document.getElementById("filterbp");
                    for (var option in select) {
                        select.remove(option);
                    }
                    */
                    receiptTable.column(3).every( function () {
                        var column = this;
                        var select = jQuery('<select id="filterbp" name="filterbp" style="width: 100px;"></select>')
                        .appendTo( jQuery(column.header()).empty() )
                        .on('change', function () {
                            var val = jQuery.fn.dataTable.util.escapeRegex(
                                jQuery(this).val()
                            );
                            column.search( val ? '^'+val+'$' : '', true, false ).draw();
                        });
                        column.data().unique().sort().each( function ( d, j ) {
                            select.append(new Option(d, d));
                        });
                    });
                    /*
                    receiptTable.rows().every(function (i, element) {
                        var data = this.data();
                        document.getElementById("filterbp").add(new Option(data[2], data[2]));
                    });
                    */
                    $('#filterbp').trigger('change');

                }, 1000);
            });

            $('#myItemList').on('shown', function() {
                setTimeout(function(){ 
                    itemTable.columns.adjust();
                }, 1000);
            });

            $('#myDIV').modal('hide');
        })

        succeededAjaxFn_getMobile_UserProfile = function (data, textStatus, jqXHR) {
            console.log("succeededAjaxFn_getMobile_UserProfile: " + textStatus);

            result_getMobile_UserProfile = JSON.parse(data.d);

            comp = result_getMobile_UserProfile.GetSetcomp;
            $('#comp').text('[' + comp + ']');
        }

        //notification for failed ajax transaction
        failedAjaxFn_getMobile_UserProfile = function (jqXHR, textStatus, errorThrown) {
            console.log("failedAjaxFn_getMobile_UserProfile: " + textStatus);
            //$('#myDIV').modal('hide');
        }

        succeededAjaxFn_getMobile_TaxCodeList = function (data, textStatus, jqXHR) {
            console.log("succeededAjaxFn_getMobile_TaxCodeList: " + textStatus);

            var select = document.getElementById("selTaxCode" + data[3]);
            for (var option in select) {
                select.remove(option);
            }
            document.getElementById("selTaxCode").add(new Option("-Select-", ""));

            result_getMobile_TaxCodeList = JSON.parse(data.d);
            $.each(result_getMobile_TaxCodeList, function (i, result) {
                document.getElementById("selTaxCode").add(new Option(result.GetSettaxcode, result.GetSettaxcode));
            });

        }

        //notification for failed ajax transaction
        failedAjaxFn_getMobile_TaxCodeList = function (jqXHR, textStatus, errorThrown) {
            console.log("failedAjaxFn_getMobile_TaxCodeList: " + textStatus);
            //$('#myDIV').modal('hide');
        }

        succeededAjaxFn_getMobile_ExpensesDetails = function (data, textStatus, jqXHR) {
            console.log("succeededAjaxFn_getMobile_ExpensesDetails: " + textStatus);
            //oTable.dataTable().fnClearTable();
            oTable.clear().draw();

            result_getMobile_ExpensesDetails = JSON.parse(data.d);
            $('#recordexpensesno').val(result_getMobile_ExpensesDetails.GetSetexpensesno);
            $('#recordexpensesdate').val(result_getMobile_ExpensesDetails.GetSetexpensesdate);
            $('#recordexpensescat').val(result_getMobile_ExpensesDetails.GetSetexpensescat);
            $('#recordexpensestype').val(result_getMobile_ExpensesDetails.GetSetexpensestype);
            $('#recordbpid').val(result_getMobile_ExpensesDetails.GetSetbpid);
            $('#recordbpdesc').val(result_getMobile_ExpensesDetails.GetSetbpdesc);
            $('#recordbpaddress').val(result_getMobile_ExpensesDetails.GetSetbpaddress);
            $('#recordbpcontact').val(result_getMobile_ExpensesDetails.GetSetbpcontact);
            $('#recordexpensesremarks').val(result_getMobile_ExpensesDetails.GetSetremarks);
            $('#recordexpensesstatus').val(result_getMobile_ExpensesDetails.GetSetstatus);
            if ($('#recordexpensesstatus').val() == 'NEW' || $('#recordexpensesstatus').val() == 'INPROGRESS') {
                $('#additemblock').show();
                $('#btnCancel').show();
            } else {
                $('#additemblock').hide();
                $('#btnCancel').hide();
            }

        }

        //notification for failed ajax transaction
        failedAjaxFn_getMobile_ExpensesDetails = function (jqXHR, textStatus, errorThrown) {
            console.log("failedAjaxFn_getMobile_ExpensesDetails: " + textStatus);
        }

        succeededAjaxFn_getMobile_ExpensesItems = function (data, textStatus, jqXHR) {
            console.log("succeededAjaxFn_getMobile_ExpensesItems: " + textStatus);
            //oTable.dataTable().fnClearTable();
            oTable.clear().draw();

            result_getMobile_ExpensesItems = JSON.parse(data.d);
            $.each(result_getMobile_ExpensesItems, function (i, result) {
                //console.log("succeededAjaxFn_getMobile_ExpensesItems: " + result.GetSetcomp + ":" + result.GetSetexpensesno);
                //$('<tr><td></td><td><input type="text" id="itemno" name="itemno" class="form-control" placeholder="" /></td><td><input type="text" id="qty" name="qty" class="form-control" placeholder="" /></td><td><button type="button" class="btn btn-sm" onclick="additem();"><i class="fa fa-save"></i></button></td></tr>').appendTo('#expenseslist');
                oTable.row.add([
                    i + 1,
                    result.GetSetcomp,
                    result.GetSetexpensesno,
                    result.GetSetlineno,
                    result.GetSetreceiptno,
                    result.GetSetreceipt_lineno,
                    result.GetSetitemno,
                    result.GetSetitemdesc,
                    result.GetSetitemno + '<br/>' + result.GetSetitemdesc + '<br/>Harga Item: RM' + result.GetSetunitprice + '/' + result.GetSetitemtype + '<br/>Diskaun: RM' + result.GetSetdiscamount + '/' + result.GetSetitemtype + '<br/>TAX: RM' + result.GetSettaxamount,
                    result.GetSetquantity,
                    result.GetSetunitprice,
                    formatMoney(result.GetSettotalexpenses),
                    result.GetSettaxcode
                ]).draw(false);
            });
        }

        //notification for failed ajax transaction
        failedAjaxFn_getMobile_ExpensesItems = function (jqXHR, textStatus, errorThrown) {
            console.log("failedAjaxFn_getMobile_ExpensesItems: " + textStatus);
        }

        /*
        var bpotherArray = $.map(bpother, function (value, key) {
            return {
                value: value,
                data: key
            };
        });

        succeededAjaxFn_getMobile_BPListAutocomplete = function (data, textStatus, jqXHR) {
            console.log("succeededAjaxFn_getMobile_BPListAutocomplete: " + textStatus);

            result_getMobile_BPListAutocomplete = JSON.parse(data.d);

            searchBPArray = $.map(result_getMobile_BPListAutocomplete, function (value, key) {
                return {
                    value: value,
                    data: key
                };
            });

            // initialize autocomplete with custom appendTo
            $('#searchbpiddesc').autocomplete({
                lookup: searchBPArray,
                appendTo: '#searchbpiddesc-container',
                onSelect: function (suggestion) {
                    alert(suggestion.data);
                }
            });


        };

        //notification for failed ajax transaction
        failedAjaxFn_getMobile_BPListAutocomplete = function (jqXHR, textStatus, errorThrown) {
            console.log("failedAjaxFn_getMobile_BPListAutocomplete: " + textStatus);
        }
        */

        function searching() {
            $('#myDIV').modal({ backdrop: "static" });
            if($('#searchtype').val() == "RECEIPTNO")
            {
                var parameters_getMobile_ReceiptList = ["comp", comp, "bpid", "", "ordertype", "", "expensescat", "PURCHASE_INVOICE", "receiptno", $('#searchitem').val(), "orderno", "", "itemno", ""];
                PageMethod("getMobile_PendingExpensesReceiptList", parameters_getMobile_ReceiptList, succeededAjaxFn_getMobile_ReceiptList, failedAjaxFn_getMobile_ReceiptList, false);
            }
            else if($('#searchtype').val() == "ORDERNO")
            {
                var parameters_getMobile_ReceiptList = ["comp", comp, "bpid", "", "ordertype", "", "expensescat", "PURCHASE_INVOICE", "receiptno", "", "orderno", $('#searchitem').val(), "itemno", ""];
                PageMethod("getMobile_PendingExpensesReceiptList", parameters_getMobile_ReceiptList, succeededAjaxFn_getMobile_ReceiptList, failedAjaxFn_getMobile_ReceiptList, false);
            }
            else if($('#searchtype').val() == "BPID")
            {
                var parameters_getMobile_BPList = ["comp", comp, "bpid", $('#searchitem').val(), "bpdesc", "", "bpcat", "", "solidbp", "Y"];
                PageMethod("getMobile_BPList", parameters_getMobile_BPList, succeededAjaxFn_getMobile_BPList, failedAjaxFn_getMobile_BPList, false);
            }
            else if($('#searchtype').val() == "BPDESC")
            {
                var parameters_getMobile_BPList = ["comp", comp, "bpid", "", "bpdesc", $('#searchitem').val(), "bpcat", "", "solidbp", "Y"];
                PageMethod("getMobile_BPList", parameters_getMobile_BPList, succeededAjaxFn_getMobile_BPList, failedAjaxFn_getMobile_BPList, false);
            }


        }

        succeededAjaxFn_getMobile_BPList = function (data, textStatus, jqXHR) {
            console.log("succeededAjaxFn_getMobile_BPList: " + textStatus);
            $('#myDIV').modal('hide');

            //$('#myBPList').modal({ backdrop: "static" });
            $('#myBPList').modal('show');
            bpTable.clear().draw();

            result_getMobile_BPList = JSON.parse(data.d);
            $.each(result_getMobile_BPList, function (i, result) {
                //$('<tr><td>' + result.GetSetbpid + '</td><td>' + result.GetSetbpdesc + '</td><td>' + result.GetSetbpaddress + '</td><td>' + result.GetSetbpcontact + '</td></tr>').appendTo('#tbBPList');
                bpTable.row.add([
                    i + 1,
                    result.GetSetbpid,
                    result.GetSetbpdesc,
                    result.GetSetbpaddress,
                    result.GetSetbpcontact,
                    result.GetSetbpid + '<br/>' + result.GetSetbpdesc + '<br/>' + result.GetSetbpaddress
                ]).draw(false);
            });

        };

        //notification for failed ajax transaction
        failedAjaxFn_getMobile_BPList = function (jqXHR, textStatus, errorThrown) {
            console.log("failedAjaxFn_getMobile_BPList: " + textStatus);
            $('#myDIV').modal('hide');
        }

        succeededAjaxFn_getMobile_ReceiptList = function (data, textStatus, jqXHR) {
            console.log("succeededAjaxFn_getMobile_ReceiptList: " + textStatus);
            $('#myDIV').modal('hide');

            //$('#myBPList').modal({ backdrop: "static" });
            $('#myReceiptList').modal('show').trigger('shown');
            receiptTable.clear().draw();

            result_getMobile_ReceiptList = JSON.parse(data.d);
            var rowno = 0;
            $.each(result_getMobile_ReceiptList, function (i, result) {
                rowno = i + 1;
                receiptTable.row.add([
                    '<input id="addcheck_' + rowno + '" name="addcheck_' + rowno + '" type="checkbox" />',
                    rowno,
                    result.GetSetbpid,
                    result.GetSetbpdesc,
                    result.GetSetreceiptno,
                    result.GetSetlineno,
                    result.GetSetorderno,
                    result.GetSetorder_lineno,
                    result.GetSetitemno,
                    result.GetSetreceiptno + '<br/>' + result.GetSetorderno + '<br/>' + result.GetSetitemno + '<br/>' + result.GetSetitemdesc + '<br/>Harga: RM' + result.GetSetunitprice + "/" + result.GetSetitemtype + '<br/>Diskaun: RM' + result.GetSetdiscamount + "/" + result.GetSetitemtype + '<br/>Qty: ' + result.GetSetquantity + '<br/>Jumlah: RM' + result.GetSettotalexpenses
                ]).draw(false);
            });

        };

        //notification for failed ajax transaction
        failedAjaxFn_getMobile_ReceiptList = function (jqXHR, textStatus, errorThrown) {
            console.log("failedAjaxFn_getMobile_ReceiptList: " + textStatus);
            $('#myDIV').modal('hide');
        }

        function resetsearching() {
            $('#searchitem').val('');
        }

        function openbpdetails(bpid, bpdesc, bpaddress, bpcontact) {
            $('#searchblock').hide();
            $('#foundblock').show();

            $('#foundbpid').val(bpid);
            $('#foundbpdesc').val(bpdesc);
            $('#foundbpaddress').val(bpaddress);
            $('#foundbpcontact').val(bpcontact);

            $('#myBPList').modal('hide');
        }

        function resetfound() {
            $('#searchblock').show();
            $('#foundblock').hide();

            resetsearching();
            $('#foundbpid').val('');
            $('#foundbpdesc').val('');
            $('#foundbpaddress').val('');
            $('#foundbpcontact').val('');
        }

        function createexpenses() {

            $('#myDIV').modal({ backdrop: "static" });

            var parameters_createMobile_ExpensesExpenses = ["comp", comp, "bpid", $('#foundbpid').val(), "expensescat", $('#foundexpensescat').val(), "expensestype", $('#foundexpensestype').val(), "userid", userid];
            PageMethod("createMobile_ExpensesHeader", parameters_createMobile_ExpensesExpenses, succeededAjaxFn_createMobile_ExpensesExpenses, failedAjaxFn_createMobile_ExpensesExpenses, false);

            if (successcreationexpenses) {
                $('#searchblock').hide();
                $('#foundblock').hide();

                resetsearching();
                $('#foundbpid').val('');
                $('#foundbpdesc').val('');
                $('#foundbpaddress').val('');
                $('#foundbpcontact').val('');

                $('#recordblock').show();
                $('#additemblock').show();

                var parameters_getMobile_ExpensesDetails = ["comp", comp, "expensesno", expensesno];
                PageMethod("getMobile_ExpensesDetails", parameters_getMobile_ExpensesDetails, succeededAjaxFn_getMobile_ExpensesDetails, failedAjaxFn_getMobile_ExpensesDetails, false);

                var parameters_getMobile_ExpensesItems = ["comp", comp, "expensesno", expensesno];
                PageMethod("getMobile_ExpensesItems", parameters_getMobile_ExpensesItems, succeededAjaxFn_getMobile_ExpensesItems, failedAjaxFn_getMobile_ExpensesItems, false);

            } else {
                alert('Internal System Error!');
            }

            $('#myDIV').modal('hide');
        }

        succeededAjaxFn_createMobile_ExpensesExpenses = function (data, textStatus, jqXHR) {
            console.log("succeededAjaxFn_createMobile_ExpensesExpenses: " + textStatus);

            result_createMobile_ExpensesExpenses = JSON.parse(data.d);
            if (result_createMobile_ExpensesExpenses.status == "Y") {
                successcreationexpenses = true;
                expensesno = result_createMobile_ExpensesExpenses.message;
            }
            else {
                successcreationexpenses = false;
                expensesno = "";
            }
        };

        //notification for failed ajax transaction
        failedAjaxFn_createMobile_ExpensesExpenses = function (jqXHR, textStatus, errorThrown) {
            console.log("failedAjaxFn_createMobile_ExpensesExpenses: " + textStatus);
            successcreationexpenses = false;
            expensesno = "";
        }

        function addnewitem() {

            $('#myDIV').modal({ backdrop: "static" });

            var parameters_getMobile_PendingExpensesList = ["comp", comp, "bpid", $('#recordbpid').val(), "expensescat", $('#recordexpensescat').val(), "expensestype", $('#recordexpensestype').val()];
            PageMethod("getMobile_PendingExpensesList", parameters_getMobile_PendingExpensesList, succeededAjaxFn_getMobile_PendingExpensesList, failedAjaxFn_getMobile_PendingExpensesList, false);

            //itemTable.columns.adjust();
        }

        succeededAjaxFn_getMobile_PendingExpensesList = function (data, textStatus, jqXHR) {
            console.log("succeededAjaxFn_getMobile_PendingExpensesList: " + textStatus);
            $('#myDIV').modal('hide');

            if($('#recordexpensescat').val() == "PURCHASE_INVOICE")
            {
                //$('#myItemList').modal({ backdrop: "static" });
                $('#myItemList').modal('show').trigger('shown');

                itemTable.clear().draw();

                result_getMobile_PendingExpensesList = JSON.parse(data.d);
                var rowno = 0;
                $.each(result_getMobile_PendingExpensesList, function (i, result) {
                    rowno = i + 1;
                    itemTable.row.add([
                        '<input id="addcheck_' + rowno + '" name="addcheck_' + rowno + '" type="checkbox" />',
                        rowno,
                        result.GetSetreceiptno,
                        result.GetSetlineno,
                        result.GetSetorderno,
                        result.GetSetorder_lineno,
                        result.GetSetitemno,
                        result.GetSetitemdesc,
                        result.GetSetunitcost,
                        result.GetSetunitprice,
                        result.GetSetdiscamount,
                        result.GetSetquantity,
                        result.GetSetcostprice,
                        result.GetSetexpensesprice,
                        result.GetSettaxcode,
                        result.GetSettaxrate,
                        result.GetSettaxamount,
                        result.GetSettotalexpenses,
                        result.GetSetitemno + '<br/>' + result.GetSetitemdesc + '<br/>' + result.GetSetitemcat + '<br/>Harga Item: RM' + result.GetSetunitprice + "/" + result.GetSetitemtype + '<br/>Diskaun: RM' + result.GetSetdiscamount + "/" + result.GetSetitemtype + '<br/>TAX: ' + result.GetSettaxrate + "%" + '<br/>Receipt: ' + result.GetSetreceiptno + '<br/>Order: ' + result.GetSetorderno,
                        result.GetSetquantity,
                        result.GetSettotalexpenses
                    ]).draw(false);

                });
                //$('#myItemList').modal('show').trigger('shown');

            }
            else if($('#recordexpensescat').val() == "PAYMENT_VOUCHER")
            {
                $('#myItemList2').modal('show');
                itemTable2.clear().draw();

                result_getMobile_PendingExpensesList = JSON.parse(data.d);
                var rowno = 0;
                $.each(result_getMobile_PendingExpensesList, function (i, result) {
                    rowno = i + 1;
                    itemTable2.row.add([
                        rowno,
                        rowno,
                        result.GetSetparamid,
                        result.GetSetparamdesc,
                        result.GetSetparamid + '<br/>' + result.GetSetparamdesc,
                        0,
                        0
                    ]).draw(false);
                });

                /*
                itemTable2.rows().every(function (x, element) {
                    var data = this.data();
                    var rowno = data[1];
                    $('#addunitprice_' + rowno).change(function () {
                        var expensesprice = $('#addunitprice_' + rowno).val() * $('#addquantity_' + rowno).val();
                        $('#addexpensesprice_' + rowno).val(expensesprice.toFixed(2));
                        var totamnt = parseFloat($('#addexpensesprice_' + rowno).val());
                        $('#addtotalexpenses_' + rowno).val(totamnt.toFixed(2));
                        alert($('#addtotalexpenses_' + rowno).val());
                    });
                    $('#addquantity_' + rowno).change(function () {
                        var expensesprice = $('#addunitprice_' + rowno).val() * $('#addquantity_' + rowno).val();
                        $('#addexpensesprice_' + rowno).val(expensesprice.toFixed(2));
                        var totamnt = parseFloat($('#addexpensesprice_' + rowno).val());
                        $('#addtotalexpenses_' + rowno).val(totamnt.toFixed(2));
                    });
                });
                */
                /*
                $('#tbItemList2 tbody').on('click', 'tr', function () {
                    var data = itemTable2.row(this).data();
                    var rowno = data[1];
                    $('#addunitprice_' + rowno).change(function () {
                        var expensesprice = $('#addunitprice_' + rowno).val() * $('#addquantity_' + rowno).val();
                        $('#addexpensesprice_' + rowno).val(expensesprice.toFixed(2));
                        var totamnt = parseFloat($('#addexpensesprice_' + rowno).val());
                        $('#addtotalexpenses_' + rowno).val(totamnt.toFixed(2));
                    });
                    $('#addquantity_' + rowno).change(function () {
                        var expensesprice = $('#addunitprice_' + rowno).val() * $('#addquantity_' + rowno).val();
                        $('#addexpensesprice_' + rowno).val(expensesprice.toFixed(2));
                        var totamnt = parseFloat($('#addexpensesprice_' + rowno).val());
                        $('#addtotalexpenses_' + rowno).val(totamnt.toFixed(2));
                    });
                });
                */

            }

        };

        //notification for failed ajax transaction
        failedAjaxFn_getMobile_PendingExpensesList = function (jqXHR, textStatus, errorThrown) {
            console.log("failedAjaxFn_getMobile_PendingExpensesList: " + textStatus);
            $('#myDIV').modal('hide');
        }

        function addlineitem(){
            $('#myItemList').modal('hide');
            $('#myDIV').modal({ backdrop: "static" });

            itemTable.rows().every(function (x, element) {
                var data = this.data();
                var rowno = data[1];
                if($('#addcheck_' + rowno).prop("checked") == true){
                    additemdetails(data[1], data[2], data[3], data[4], data[5], data[6], data[7], data[8], data[9], data[10], data[11], data[12], data[13], data[14], data[15], data[16], data[17]);
                }
            });

            $('#myDIV').modal('hide');
        }

        function additemdetails(rowno, receiptno, receipt_lineno, orderno, order_lineno, itemno, itemdesc, unitcost, unitprice, discamount, quantity, costprice, expensesprice, taxcode, taxrate, taxamount, totalexpenses) {
            
            if($('#recordexpensescat').val() == "PAYMENT_VOUCHER")
            {
                $('#myItemList2').modal('hide');            
                $('#myDIV').modal({ backdrop: "static" });
            }   
            
            var parameters_addMobile_ExpensesItemDetails = ["comp", comp, "expensesno", expensesno, "receiptno", receiptno, "receiptlineno", receipt_lineno, "orderno", orderno, "lineno", order_lineno, "itemno", itemno, "itemdesc", itemdesc, "unitcost", unitcost, "unitprice", unitprice, "discamount", discamount, "quantity", quantity, "costprice", costprice, "expensesprice", expensesprice, "taxcode", taxcode, "taxrate", taxrate, "taxamount", taxamount, "totalexpenses", totalexpenses];
            PageMethod("addMobile_ExpensesItemDetails", parameters_addMobile_ExpensesItemDetails, succeededAjaxFn_addMobile_ExpensesItemDetails, failedAjaxFn_addMobile_ExpensesItemDetails, false);

            if (successadditem) {

                var parameters_getMobile_ExpensesItems = ["comp", comp, "expensesno", expensesno];
                PageMethod("getMobile_ExpensesItems", parameters_getMobile_ExpensesItems, succeededAjaxFn_getMobile_ExpensesItems, failedAjaxFn_getMobile_ExpensesItems, false);

            } else {
                alert(errormessage);
            }

            if($('#recordexpensescat').val() == "PAYMENT_VOUCHER")
            {            
                $('#myDIV').modal('hide');
            }
        }

        succeededAjaxFn_addMobile_ExpensesItemDetails = function (data, textStatus, jqXHR) {
            console.log("succeededAjaxFn_addMobile_ExpensesItemDetails: " + textStatus);

            result = JSON.parse(data.d);
            if (result.status == "Y") {
                successadditem = true;
                errormessage = "";
            }
            else {
                successadditem = false;
                errormessage = result.message;
            }
        };

        //notification for failed ajax transaction
        failedAjaxFn_addMobile_ExpensesItemDetails = function (jqXHR, textStatus, errorThrown) {
            console.log("failedAjaxFn_addMobile_ExpensesItemDetails: " + textStatus);
            successadditem = false;
            errormessage = "Internal Server Error!";
        }

        function addreceiptitem(){
            $('#myReceiptList').modal('hide');
            $('#myDIV').modal({ backdrop: "static" });

            successcreationexpenses = true;
            successadditem = true;
            var rowno = 1;
            receiptTable.rows().every(function (x, element) {
                var data = this.data();                
                if($('#addcheck_' + data[1]).prop("checked") == true && successcreationexpenses == true && successadditem == true){
                    addreceiptitemdetails(rowno, data[2], data[4], data[5], data[6], data[7], data[8]);
                    rowno = rowno + 1;
                }
            });

            if(successcreationexpenses && successadditem){
                window.location.href = "BIOAppMobile_ExpensesPage.html?userid=" + userid + "&comp=" + comp + "&expensesno=" + expensesno;
            }else{
                alert(errormessage);
            }

            $('#myDIV').modal('hide');
        }

        function addreceiptitemdetails(rowno, bpid, receiptno, receipt_lineno, orderno, order_lineno, itemno) {
            
            if(rowno==1)
            {
                var parameters_addMobile_ExpensesReceiptItemHeader = ["comp", comp, "expensescat", "PURCHASE_INVOICE", "receiptno", receiptno, "receiptlineno", receipt_lineno, "orderno", orderno, "orderlineno", order_lineno, "itemno", itemno, "userid", userid];
                PageMethod("addMobile_ExpensesReceiptItemHeader", parameters_addMobile_ExpensesReceiptItemHeader, succeededAjaxFn_addMobile_ExpensesReceiptItemHeader, failedAjaxFn_addMobile_ExpensesReceiptItemHeader, false);
            }
            if (successcreationexpenses == true && expensesno.length > 0) {

                var parameters_addMobile_ExpensesReceiptItemDetails = ["comp", comp, "expensesno", expensesno, "expensescat", "PURCHASE_INVOICE", "receiptno", receiptno, "receiptlineno", receipt_lineno, "orderno", orderno, "orderlineno", order_lineno, "itemno", itemno, "userid", userid];
                PageMethod("addMobile_ExpensesReceiptItemDetails", parameters_addMobile_ExpensesReceiptItemDetails, succeededAjaxFn_addMobile_ExpensesReceiptItemDetails, failedAjaxFn_addMobile_ExpensesReceiptItemDetails, false);

            } 

        }

        succeededAjaxFn_addMobile_ExpensesReceiptItemHeader = function (data, textStatus, jqXHR) {
            console.log("succeededAjaxFn_addMobile_ExpensesReceiptItemHeader: " + textStatus);

            result = JSON.parse(data.d);
            if (result.status == "Y") {
                successcreationexpenses = true;
                expensesno = result.message;
                errormessage = "";
            }
            else {
                successcreationexpenses = false;
                errormessage = result.message;
            }
        };

        //notification for failed ajax transaction
        failedAjaxFn_addMobile_ExpensesReceiptItemHeader = function (jqXHR, textStatus, errorThrown) {
            console.log("failedAjaxFn_addMobile_ExpensesReceiptItemHeader: " + textStatus);
            successadditem = false;
            errormessage = "Internal Server Error!";
        }

        succeededAjaxFn_addMobile_ExpensesReceiptItemDetails = function (data, textStatus, jqXHR) {
            console.log("succeededAjaxFn_addMobile_ExpensesReceiptItemDetails: " + textStatus);

            result = JSON.parse(data.d);
            if (result.status == "Y") {
                successadditem = true;
                errormessage = "";
            }
            else {
                successadditem = false;
                errormessage = result.message;
            }
        };

        //notification for failed ajax transaction
        failedAjaxFn_addMobile_ExpensesReceiptItemDetails = function (jqXHR, textStatus, errorThrown) {
            console.log("failedAjaxFn_addMobile_ExpensesReceiptItemDetails: " + textStatus);
            successadditem = false;
            errormessage = "Internal Server Error!";
        }

        function openlist() {
            window.location.href = "BIOAppMobile_ExpensesList.html?userid=" + userid;
        }

        function viewlineitem(lineno, receiptno, receiptlineno, itemno, itemdesc, qty, unitprice, totalexpenses, taxcode) {
            $('#myLineItem').modal('show');
            $('#lblLineItemNo').text(itemno);
            //$('#lblLineTotalExpenses').text('RM' + totalexpenses);

            $('#txtLineItemDesc').val(itemdesc);
            $('#txtLineNo').val(lineno);
            $('#txtLineReceiptNo').val(receiptno);
            $('#txtLineReceiptLineNo').val(receiptlineno);
            $('#txtLineItemNo').val(itemno);
            $('#txtLineItemQty').val(qty);
            $('#txtLineUnitPrice').val(unitprice);
            $('#selTaxCode').val(taxcode);

            if($('#recordexpensescat').val() == "PAYMENT_VOUCHER")
            {
                $("#txtLineItemDesc").prop("readonly", false);
                $("#txtLineItemQty").prop("readonly", false);
                $("#txtLineUnitPrice").prop("readonly", false);
                $("#selTaxCode").prop("disabled", false);
                $("#btnEditLineItem").show();
            }
            else
            {
                $("#txtLineItemDesc").prop("readonly", true);
                $("#txtLineItemQty").prop("readonly", true);
                $("#txtLineUnitPrice").prop("readonly", true);
                $("#selTaxCode").prop("disabled", true);
                $("#btnEditLineItem").hide();
            }
        }

        $("#txtLineItemQty").change(function(){
            calculateTotalAmount();
        });

        $("#txtLineUnitPrice").change(function(){
            calculateTotalAmount();
        });

        function calculateTotalAmount() {
            var expensesprice = $('#txtLineUnitPrice').val() * $('#txtLineItemQty').val();
            //$('#lblLineTotalExpenses').text("RM" + expensesprice.toFixed(2));
        }

        function editlineitem() {
            $('#myLineItem').modal('hide');

            $('#myDIV').modal({ backdrop: "static" });

            var parameters_editMobile_ExpensesItemExpenses = ["comp", comp, "expensesno", expensesno, "lineno", $('#txtLineNo').val(), "receiptno", $('#txtReceiptNo').val(), "receiptlineno", $('#txtReceiptLineNo').val(), "itemno", $('#txtLineItemNo').val(), "itemdesc", $('#txtLineItemDesc').val(), "qty", $('#txtLineItemQty').val(), "unitprice", $('#txtLineUnitPrice').val(), "taxcode", $('#selTaxCode').val()];
            PageMethod("editMobile_ExpensesItemDetails", parameters_editMobile_ExpensesItemExpenses, succeededAjaxFn_editMobile_ExpensesItemExpenses, failedAjaxFn_editMobile_ExpensesItemExpenses, false);

            if (successedititem) {

                var parameters_getMobile_ExpensesItems = ["comp", comp, "expensesno", expensesno];
                PageMethod("getMobile_ExpensesItems", parameters_getMobile_ExpensesItems, succeededAjaxFn_getMobile_ExpensesItems, failedAjaxFn_getMobile_ExpensesItems, false);

            } else {
                alert(errormessage);
            }

            $('#myDIV').modal('hide');
        }

        succeededAjaxFn_editMobile_ExpensesItemExpenses = function (data, textStatus, jqXHR) {
            console.log("succeededAjaxFn_editMobile_ExpensesItemExpenses: " + textStatus);

            result = JSON.parse(data.d);
            if (result.status == "Y") {
                successedititem = true;
                errormessage = "";
            }
            else {
                successedititem = false;
                errormessage = result.message;
            }
        };

        //notification for failed ajax transaction
        failedAjaxFn_editMobile_ExpensesItemExpenses = function (jqXHR, textStatus, errorThrown) {
            console.log("failedAjaxFn_editMobile_ExpensesItemExpenses: " + textStatus);
            successedititem = false;
            errormessage = "Internal Server Error!";
        }

        function deletelineitem() {
            $('#myLineItem').modal('hide');

            $('#myDIV').modal({ backdrop: "static" });

            var parameters_deleteMobile_ExpensesItemDetails = ["comp", comp, "expensesno", expensesno, "lineno", $('#txtLineNo').val(), "receiptno", $('#txtReceiptNo').val(), "receiptlineno", $('#txtReceiptLineNo').val(), "itemno", $('#txtLineItemNo').val()];
            PageMethod("deleteMobile_ExpensesItemDetails", parameters_deleteMobile_ExpensesItemDetails, succeededAjaxFn_deleteMobile_ExpensesItemDetails, failedAjaxFn_deleteMobile_ExpensesItemDetails, false);

            if (successdeleteitem) {

                var parameters_getMobile_ExpensesItems = ["comp", comp, "expensesno", expensesno];
                PageMethod("getMobile_ExpensesItems", parameters_getMobile_ExpensesItems, succeededAjaxFn_getMobile_ExpensesItems, failedAjaxFn_getMobile_ExpensesItems, false);

            } else {
                alert(errormessage);
            }

            $('#myDIV').modal('hide');
        }

        succeededAjaxFn_deleteMobile_ExpensesItemDetails = function (data, textStatus, jqXHR) {
            console.log("succeededAjaxFn_deleteMobile_ExpensesItemDetails: " + textStatus);

            result = JSON.parse(data.d);
            if (result.status == "Y") {
                successdeleteitem = true;
                errormessage = "";
            }
            else {
                successdeleteitem = false;
                errormessage = result.message;
            }
        };

        //notification for failed ajax transaction
        failedAjaxFn_deleteMobile_ExpensesItemDetails = function (jqXHR, textStatus, errorThrown) {
            console.log("failedAjaxFn_deleteMobile_ExpensesItemDetails: " + textStatus);
            successdeleteitem = false;
            errormessage = "Internal Server Error!";
        }

        function cancelexpenses() {
            $('#myDIV').modal({ backdrop: "static" });

            var parameters_updateMobile_ExpensesHeaderStatus = ["comp", comp, "expensesno", expensesno, "status", "CANCELLED", "userid", userid];
            PageMethod("updateMobile_ExpensesHeaderStatus", parameters_updateMobile_ExpensesHeaderStatus, succeededAjaxFn_updateMobile_ExpensesHeaderStatus, failedAjaxFn_updateMobile_ExpensesHeaderStatus, false);

            if (successcancelexpenses) {
                window.location.href = "BIOAppMobile_ExpensesPage.html?userid=" + userid + "&comp=" + comp + "&expensesno=" + expensesno;
            }
            else
            {
                alert(errormessage);
            }

            $('#myDIV').modal('hide');
        }

        succeededAjaxFn_updateMobile_ExpensesHeaderStatus = function (data, textStatus, jqXHR) {
            console.log("succeededAjaxFn_updateMobile_ExpensesHeaderStatus: " + textStatus);

            result = JSON.parse(data.d);
            if (result.status == "Y") {
                successcancelexpenses = true;
                errormessage = "";
            }
            else {
                successcancelexpenses = false;
                errormessage = result.message;
            }
        }

        //notification for failed ajax transaction
        failedAjaxFn_updateMobile_ExpensesHeaderStatus = function (jqXHR, textStatus, errorThrown) {
            console.log("failedAjaxFn_updateMobile_ExpensesHeaderStatus: " + textStatus);
            successcancelexpenses = false;
            errormessage = "Internal Server Error!";
        }

        function openpaymentpaid() {
            window.location.href = "BIOAppMobile_PaymentPaidPage.html?userid=" + userid + "&comp=" + comp + "&expensesno=" + expensesno;
        }

        function formatMoney(amount, decimalCount = 2, decimal = ".", thousands = ",") {
            try {
                decimalCount = Math.abs(decimalCount);
                decimalCount = isNaN(decimalCount) ? 2 : decimalCount;

                const negativeSign = amount < 0 ? "-" : "";

                let i = parseInt(amount = Math.abs(Number(amount) || 0).toFixed(decimalCount)).toString();
                let j = (i.length > 3) ? i.length % 3 : 0;

                return negativeSign + (j ? i.substr(0, j) + thousands : '') + i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + thousands) + (decimalCount ? decimal + Math.abs(amount - i).toFixed(decimalCount).slice(2) : "");
            } catch (e) {
                console.log(e)
            }
        }
    </script>
</body>
</html>
